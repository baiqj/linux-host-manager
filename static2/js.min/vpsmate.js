var releasetime="2013-01-18 18:32:57 CST";var _v=new Date(releasetime.replace(/-/g,"/")).getTime()/1000;angular.module("vpsmate",["vpsmate.services","vpsmate.directives","vpsmate.filters"]).config(["$routeProvider",function(a){var b=function(e,g,d){var f={templateUrl:template_path+"/partials/"+e+".html?_v="+_v,controller:g,reloadOnSearch:false};if(!d){f.resolve=Auth}return f};a.when("/",b("login",LoginCtrl,true)).when("/main",b("main",MainCtrl)).when("/service/nginx",b("service/nginx",ServiceNginxCtrl)).when("/service/apache",b("service/apache",ServiceApacheCtrl)).when("/service/vsftpd",b("service/vsftpd",ServiceVsftpdCtrl)).when("/service/mysql",b("service/mysql",ServiceMySQLCtrl)).when("/service/redis",b("service/redis",ServiceRedisCtrl)).when("/service/memcache",b("service/memcache",ServiceMemcacheCtrl)).when("/service/mongodb",b("service/mongodb",ServiceMongoDBCtrl)).when("/service/php",b("service/php",ServicePHPCtrl)).when("/service/sendmail",b("service/sendmail",ServiceSendmailCtrl)).when("/service/ssh",b("service/ssh",ServiceSSHCtrl)).when("/service/iptables",b("service/iptables",ServiceIPTablesCtrl)).when("/service/cron",b("service/cron",ServiceCronCtrl)).when("/service/ntp",b("service/ntp",ServiceNTPCtrl)).when("/service",b("service/index",ServiceCtrl)).when("/file",b("file/file",FileCtrl)).when("/file/go#(:path)",b("file/file",FileCtrl)).when("/file/trash",b("file/trash",FileTrashCtrl)).when("/site",b("site/index",SiteCtrl)).when("/site/nginx/:section",b("site/nginx/site",SiteNginxCtrl)).when("/database",b("database/index",DatabaseCtrl)).when("/database/mysql/db/new",b("database/mysql/dbnew",DatabaseMySQLNewDBCtrl)).when("/database/mysql/db/edit/:section",b("database/mysql/dbedit",DatabaseMySQLEditDBCtrl)).when("/database/mysql/user/new",b("database/mysql/usernew",DatabaseMySQLNewUserCtrl)).when("/database/mysql/user/edit/:section",b("database/mysql/useredit",DatabaseMySQLEditUserCtrl)).when("/ftp",b("ftp",FtpCtrl)).when("/task",b("task",TaskCtrl)).when("/utils",b("utils/index",UtilsCtrl)).when("/utils/user",b("utils/user",UtilsUserCtrl)).when("/utils/network",b("utils/network",UtilsNetworkCtrl)).when("/utils/time",b("utils/time",UtilsTimeCtrl)).when("/utils/partition",b("utils/partition",UtilsPartitionCtrl)).when("/utils/autofm",b("utils/autofm",UtilsAutoFMCtrl)).when("/utils/movedata",b("utils/movedata",UtilsMoveDataCtrl)).when("/setting",b("setting",SettingCtrl)).when("/logout",b("logout",LogoutCtrl)).when("/sorry",b("sorry",SorryCtrl)).otherwise({redirectTo:"/sorry"})}]).run(["$rootScope","$location","Request",function(a,c,b){a.sec=function(d){c.search("s",d)};a.virt="?";a.checkVirt=function(d){if(a.virt!="?"){return}b.get("/query/server.virt",function(e){a.virt=e["server.virt"];if(d){d.call()}})};a.$mysql={password:"",password_validated:false};a.$proxyroot=location_path}]).value("version",{version:"1.0",build:"10",releasetime:releasetime,changelog:"http://www.vpsmate.org/changelog"});var Auth={auth:function(b,c,d){var a=b.defer();d.setInfo("正在加载，请稍候...",true);c.required(function(e){d.setInfo(false);if(e){a.resolve()}},function(e){if(e==403){d.setError('身份认证失败，请<a href="#/">重新登录</a>！')}else{d.setError("对不起，加载失败！（网络异常或服务器故障）")}});return a.promise},auto_auth:function(a,h,d,e){if(!a._auth_check_inited){a._auth_check_inited=true;var b=300*1000;var c=2500*1000;var g=new Date().getTime();$(document).mousemove(function(){g=new Date().getTime()});$(document).keydown(function(){g=new Date().getTime()});var f=(function(){var j=false;var i=new Date().getTime();if(i-g<b){d.required()}else{if(i-g>c){j=true;d.getlastactive(function(n){n=parseInt(n)*1000;if(i-n>c){var k=a.htmlTitle;var m=["登录超时","!!!!!!!!"];var l=0;var o=false;var p=function(){if(!o){a.htmlTitle=m[(l++)%2];e(p,1000,false,true,"_authtimeout_title")}else{a.htmlTitle=k}};p();a._authrenew=function(){g=new Date().getTime();o=true;d.required();e(f,b,false,true,"_authtimeout")};$("#_authconfirm").modal()}else{g=n;e(f,b,false,true,"_authtimeout")}})}}if(!j&&h.path()!="/"){e(f,b,false,true,"_authtimeout")}});e(f,b,false,true,"_authtimeout")}}};Auth.auth.$inject=["$q","Auth","Message"];Auth.auto_auth.$inject=["$rootScope","$location","Auth","Timeout"];var getCookie=function(a){var b=document.cookie.match("\\b"+a+"=([^;]*)\\b");return b?b[1]:undefined};